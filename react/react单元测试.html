<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Huwuji Blog | Huwuji Blog</title>
    <meta name="description" content="Huwuji Blog">
    <link rel="preload stylesheet" href="/assets/style.c21349e2.css" as="style">
    <link rel="modulepreload" href="/assets/app.ee7dae8a.js">
    <link rel="modulepreload" href="/assets/react_react单元测试.md.b613a775.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-32787701><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0c14bf17></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0c14bf17> Skip to content </a><!--]--><!----><header class="VPNav" data-v-32787701 data-v-26983493><div class="VPNavBar has-sidebar" data-v-26983493 data-v-093d49e9><div class="container" data-v-093d49e9><div class="title" data-v-093d49e9><div class="VPNavBarTitle has-sidebar" data-v-093d49e9 data-v-fb6ffc33><a class="title" href="/" data-v-fb6ffc33><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.png" alt data-v-2ecb366c><!--]--><!--[-->huwuji<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-093d49e9><div class="curtain" data-v-093d49e9></div><div class="content-body" data-v-093d49e9><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-093d49e9 data-v-f7e0d92f><span id="main-nav-aria-label" class="visually-hidden" data-v-f7e0d92f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/fe-more/Lighthouse%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E5%AE%A1%E8%AE%A1--%E4%BB%8E%E7%8E%B0%E8%B1%A1%E5%88%B0%E6%BA%90%E7%A0%81%E8%BF%BD%E8%B8%AA.html" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->前端点滴<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/react/about-useEffect.html" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->React 零零碎碎<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/v8.html" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->V8<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/node/0-Node%E7%AE%80%E4%BB%8B.html" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->Nodejs_Tutorial<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/engineering/%E5%89%8D%E7%AB%AF%E7%9B%91%E6%8E%A7.html" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->前端工程化点点<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/%E6%B5%85%E5%85%A5%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->浅入函数式编程<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="https://github.com/huwuji/blog" target="_blank" rel="noreferrer" data-v-f7e0d92f data-v-eaade15b data-v-b9be72d4><!--[-->更多<!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-b9be72d4><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-093d49e9 data-v-5165bb1b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-5165bb1b data-v-8c1a7301 data-v-f4e143c6><span class="check" data-v-f4e143c6><span class="icon" data-v-f4e143c6><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-8c1a7301><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-8c1a7301><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-093d49e9 data-v-ab33f7d9 data-v-62ba7feb><!--[--><a class="VPSocialLink" href="https://github.com/huwuji" target="_blank" rel="noopener" data-v-62ba7feb data-v-4f9e5dbf><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-093d49e9 data-v-9ee70f79 data-v-5ade3574><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-5ade3574><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-5ade3574><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-5ade3574><div class="VPMenu" data-v-5ade3574 data-v-ad9b1221><!----><!--[--><!--[--><!----><div class="group" data-v-9ee70f79><div class="item appearance" data-v-9ee70f79><p class="label" data-v-9ee70f79>Appearance</p><div class="appearance-action" data-v-9ee70f79><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-9ee70f79 data-v-8c1a7301 data-v-f4e143c6><span class="check" data-v-f4e143c6><span class="icon" data-v-f4e143c6><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-8c1a7301><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-8c1a7301><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-9ee70f79><div class="item social-links" data-v-9ee70f79><div class="VPSocialLinks social-links-list" data-v-9ee70f79 data-v-62ba7feb><!--[--><a class="VPSocialLink" href="https://github.com/huwuji" target="_blank" rel="noopener" data-v-62ba7feb data-v-4f9e5dbf><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-093d49e9 data-v-21cd31ec><span class="container" data-v-21cd31ec><span class="top" data-v-21cd31ec></span><span class="middle" data-v-21cd31ec></span><span class="bottom" data-v-21cd31ec></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-32787701 data-v-dab5d0f2><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-dab5d0f2><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-dab5d0f2><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-dab5d0f2>Menu</span></button><a class="top-link" href="#" data-v-dab5d0f2>Return to top</a></div><aside class="VPSidebar" data-v-32787701 data-v-10a4275c><div class="curtain" data-v-10a4275c></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-10a4275c><span class="visually-hidden" id="sidebar-aria-label" data-v-10a4275c> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-10a4275c><section class="VPSidebarItem level-0 has-active" data-v-10a4275c data-v-8ec0bd9d><!----><div class="items" data-v-8ec0bd9d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-8ec0bd9d data-v-8ec0bd9d><div class="item" data-v-8ec0bd9d><div class="indicator" data-v-8ec0bd9d></div><a class="VPLink link link" href="/react/about-useEffect.html" data-v-8ec0bd9d data-v-b9be72d4><!--[--><p class="text" data-v-8ec0bd9d>about-useEffect</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-8ec0bd9d data-v-8ec0bd9d><div class="item" data-v-8ec0bd9d><div class="indicator" data-v-8ec0bd9d></div><a class="VPLink link link" href="/react/react%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95.html" data-v-8ec0bd9d data-v-b9be72d4><!--[--><p class="text" data-v-8ec0bd9d>react单元测试</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-8ec0bd9d data-v-8ec0bd9d><div class="item" data-v-8ec0bd9d><div class="indicator" data-v-8ec0bd9d></div><a class="VPLink link link" href="/react/React%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" data-v-8ec0bd9d data-v-b9be72d4><!--[--><p class="text" data-v-8ec0bd9d>React源码学习笔记</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-8ec0bd9d data-v-8ec0bd9d><div class="item" data-v-8ec0bd9d><div class="indicator" data-v-8ec0bd9d></div><a class="VPLink link link" href="/react/simple-react-demo.html" data-v-8ec0bd9d data-v-b9be72d4><!--[--><p class="text" data-v-8ec0bd9d>simple-react-demo</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-32787701 data-v-995faffe><div class="VPDoc has-sidebar has-aside" data-v-995faffe data-v-909fe74b><div class="container" data-v-909fe74b><div class="aside" data-v-909fe74b><div class="aside-curtain" data-v-909fe74b></div><div class="aside-container" data-v-909fe74b><div class="aside-content" data-v-909fe74b><div class="VPDocAside" data-v-909fe74b data-v-d7440b31><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-d7440b31 data-v-3de661f7><div class="content" data-v-3de661f7><div class="outline-marker" data-v-3de661f7></div><div class="outline-title" data-v-3de661f7>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-3de661f7><span class="visually-hidden" id="doc-outline-aria-label" data-v-3de661f7> Table of Contents for current page </span><ul class="root" data-v-3de661f7 data-v-baea1980><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-d7440b31></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-909fe74b><div class="content-container" data-v-909fe74b><!--[--><!--]--><main class="main" data-v-909fe74b><div style="position:relative;" class="vp-doc _react_react%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95" data-v-909fe74b><div><h2 id="单元测试" tabindex="-1">单元测试 <a class="header-anchor" href="#单元测试" aria-hidden="true">#</a></h2><blockquote><p>原址：<a href="https://github.com/huwuji/blog/tree/master/notes/FE-thinking" target="_blank" rel="noreferrer">https://github.com/huwuji/blog/tree/master/notes/FE-thinking</a></p></blockquote><blockquote><p><strong>工程地址源码参见：</strong> <a href="https://github.com/huwuji/blog/tree/master/Demo/react-redux-generator" target="_blank" rel="noreferrer">https://github.com/huwuji/blog/tree/master/Demo/react-redux-generator</a></p></blockquote><ol><li>单元测试的框架选择---Jest+React Testing Library</li></ol><p>Jest: 相信大家都有所了解。</p><blockquote><p>Jest 是一款优雅、简洁的 JavaScript 测试框架。Jest 支持 Babel、TypeScript、Node、React、Angular、Vue 等诸多框架！</p><ul><li>无需测试；</li><li>并行隔离测试；</li><li>实时快照追踪；</li><li>文档齐全；</li></ul></blockquote><p>Enzyme：原本是想选择这个 React 测试库的，Enzyme 提供一种测试 React 组件内部的能力。但是考虑到当前项目是 React18，然后了解了一番后， 可以了解下这篇小文，<a href="https://dev.to/wojtekmaj/enzyme-is-dead-now-what-ekl" target="_blank" rel="noreferrer">Enzyme is dead. Now what?</a>, 决定使用<a href="https://testing-library.com/docs/react-testing-library/intro/" target="_blank" rel="noreferrer">React Testing Library</a>;</p><p><a href="https://testing-library.com/docs/react-testing-library/intro/" target="_blank" rel="noreferrer">React Testing Library</a></p><blockquote><p>React Testing Library builds on top of DOM Testing Library by adding APIs for working with React components. The React Testing Library is a very light-weight solution for testing React components. It provides light utility functions on top of react-dom and react-dom/test-utils, in a way that encourages better testing practices. Its primary guiding principle is: The more your tests resemble the way your software is used, the more confidence they can give you. React Testing Library 是一个 DOM 测试库，它不能直接处理 React 组件实例，而是站在应用的角度去测试，测试产物及 Dom；</p></blockquote><p>React Testing Library 具体给用户提供哪些能力及可调用的 API？ 具体参看：<a href="https://testing-library.com/docs/react-testing-library/api#renderhook-result" target="_blank" rel="noreferrer">https://testing-library.com/docs/react-testing-library/api#renderhook-result</a></p><p>同时我们也参考 React 提供的测试：<a href="https://reactjs.org/docs/testing-recipes.html" target="_blank" rel="noreferrer">https://reactjs.org/docs/testing-recipes.html</a></p><p>主要关注：</p><ul><li><p>render: 渲染组件，</p><ul><li>asFragment： 执行生成当前组件快照；</li></ul></li><li><p>renderHook： 渲染 hooks 函数 返回 - result：当前执行的结果。 - rerender：再次执行渲染</p></li><li><p>cleanup 卸载使用 render 挂载的 React 树。也是防止内存泄露</p></li><li><p>act 在编写 UI 测试时，可以将渲染、用户事件或数据获取等任务视为与用户界面交互的“单元”。react-dom/test-utils 提供了一个名为 act() 的 helper，它确保在进行任何断言之前，与这些“单元”相关的所有更新都已处理并应用于 DOM：</p></li></ul><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">act(() =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">  // 渲染组件</span></span>
<span class="line"><span style="color:#A6ACCD;">});</span></span>
<span class="line"><span style="color:#A6ACCD;">// 进行断言</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><ul><li><p>fireEvent 触发事件</p></li><li><p>waitForElement 等待异步操作</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">import {</span></span>
<span class="line"><span style="color:#A6ACCD;">render,</span></span>
<span class="line"><span style="color:#A6ACCD;">cleanup,</span></span>
<span class="line"><span style="color:#A6ACCD;">fireEvent,</span></span>
<span class="line"><span style="color:#A6ACCD;">waitForElement,</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">from &quot;@testing-library/react&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">// 每个测试单元后卸载Dom，清理内存。</span></span>
<span class="line"><span style="color:#A6ACCD;">afterEach(cleanup);</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">it(&quot;waitForElement test&quot;, async () =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">const { getByTestId, getByText } = render(&lt;TestAsync /&gt;);</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    fireEvent.click(getByTestId(&quot;button-add&quot;));</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    const counter = await waitForElement(() =&gt; getByText(&quot;1&quot;));</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">    expect(counter).toHaveTextContent(&quot;1&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">    });</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>测试用例 Demo 路径如下： <strong>[<strong>tests</strong>/test/home.test.js]</strong> 包含方法，React 组件和 hooks 的测试栗子：</p></li></ul><p>总结下，对于具体的测试方法，可以在编写测试用例的过程中，站在用户的行为角度，遍写边翻阅以上提到的文档，自然的就会不断熟悉。</p><ol start="2"><li><p>Jest 测试配置 这里参考 create-react-app，我们通过 create-react-app 创建项目后，直接 eject 出来，查看具体的配置，供我们参考。 create-react-app 的 jest 配置在 package.json 中的 jest 属性;</p><p>配置需要注意：</p><ul><li>对于 less 的解析 安装：jest-css-modules 配置<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">moduleNameMapper: {</span></span>
<span class="line"><span style="color:#A6ACCD;">&quot;\\.(css|less|scss|sss|styl)$&quot;: &quot;&lt;rootDir&gt;/node_modules/jest-css-modules&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">},</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li>静态资源引用 配置别名<div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">moduleNameMapper: {</span></span>
<span class="line"><span style="color:#A6ACCD;">  &quot;^@(.*)$&quot;: &quot;&lt;rootDir&gt;/src/$1&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">rootDir: path.join(__dirname),</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div>同时也可以根据 testMatch 属性来更精确的筛选;</li></ul><p><strong>jest.config.js 的配置文件如下</strong></p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">const path = require(&quot;path&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">module.exports = {</span></span>
<span class="line"><span style="color:#A6ACCD;"> collectCoverageFrom: [&quot;src/**/*.{js,jsx,ts,tsx}&quot;, &quot;!src/**/*.d.ts&quot;],</span></span>
<span class="line"><span style="color:#A6ACCD;"> moduleFileExtensions: [</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;js&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;mjs&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;cjs&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;jsx&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;ts&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;tsx&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;json&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;">     &quot;node&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;"> ],</span></span>
<span class="line"><span style="color:#A6ACCD;">moduleNameMapper: {</span></span>
<span class="line"><span style="color:#A6ACCD;">      &quot;\\.(css|less|scss|sss|styl)$&quot;: &quot;&lt;rootDir&gt;/node_modules/jest-css-modules&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;"> },</span></span>
<span class="line"><span style="color:#A6ACCD;"> rootDir: path.join(__dirname),</span></span>
<span class="line"><span style="color:#A6ACCD;"> roots: [&quot;&lt;rootDir&gt;&quot;],</span></span>
<span class="line"><span style="color:#A6ACCD;"> setupFilesAfterEnv: [&quot;&lt;rootDir&gt;/src/setupTests.js&quot;],</span></span>
<span class="line"><span style="color:#A6ACCD;"> testEnvironment: &quot;jsdom&quot;,</span></span>
<span class="line"><span style="color:#A6ACCD;"> testMatch: [&quot;**/__tests__/**/*.[jt]s?(x)&quot;, &quot;**/?(*.)+(spec|test).[tj]s?(x)&quot;],</span></span>
<span class="line"><span style="color:#A6ACCD;"> testPathIgnorePatterns: [&quot;/node_modules/&quot;],</span></span>
<span class="line"><span style="color:#A6ACCD;"> testRegex: [],</span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li><p>测试问题汇总：</p></li></ol><ul><li><p>问题一：关于引用 Redux 的测试问题：</p><blockquote><p>问题：could not find react-redux context value; please ensure the component is wrapped in a [Provider[]</p></blockquote><blockquote><p>参考：<a href="https://redux.js.org/usage/writing-tests#components" target="_blank" rel="noreferrer">https://redux.js.org/usage/writing-tests#components</a></p></blockquote><p>这里就需要配置引入 react-redux</p></li><li><p>问题二： 关于引入 Router</p><blockquote><p>useHref() may be used only in the context of a [Router[] component.</p></blockquote></li></ul><p>对于问题一二应用后代码如下：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">  import React from &quot;react&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  import {  render } from &quot;@testing-library/react&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  import { Provider } from &quot;react-redux&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  import { BrowserRouter, Routes, Route } from &quot;react-router-dom&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">  import getStore from &quot;../../src/store&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  import Layout from &quot;../../src/containers/layout&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  import Home from &quot;../../src/containers/home/index.js&quot;;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">  it(&quot;测试初始快照&quot;, async () =&gt; {</span></span>
<span class="line"><span style="color:#A6ACCD;">      const { asFragment, getByText } = render(</span></span>
<span class="line"><span style="color:#A6ACCD;">        &lt;Provider store={getStore()}&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">          &lt;BrowserRouter&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            &lt;Routes&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">              &lt;Route path=&quot;/&quot; element={&lt;Layout /&gt;}&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">                &lt;Route index element={&lt;Home /&gt;} /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">              &lt;/Route&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">            &lt;/Routes&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">          &lt;/BrowserRouter&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">        &lt;/Provider&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      );</span></span>
<span class="line"><span style="color:#A6ACCD;">      console.log(&quot;result==&quot;, asFragment());</span></span>
<span class="line"><span style="color:#A6ACCD;">      expect(getByText(&quot;my home page&quot;)).toBeInTheDocument;</span></span>
<span class="line"><span style="color:#A6ACCD;">  });</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-909fe74b data-v-00c22e08><!----><div class="prev-next" data-v-00c22e08><div class="pager" data-v-00c22e08><a class="pager-link prev" href="/react/about-useEffect.html" data-v-00c22e08><span class="desc" data-v-00c22e08>Previous page</span><span class="title" data-v-00c22e08>about-useEffect</span></a></div><div class="has-prev pager" data-v-00c22e08><a class="pager-link next" href="/react/React%E6%BA%90%E7%A0%81%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html" data-v-00c22e08><span class="desc" data-v-00c22e08>Next page</span><span class="title" data-v-00c22e08>React源码学习笔记</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"engineering_前端工程化简述.md\":\"7fb70b0c\",\"node_3-异步编程.md\":\"e5a4bff1\",\"react_react源码学习笔记.md\":\"352acbd5\",\"engineering_记一次处理国际化key而做的webpack-loader.md\":\"8af9d18d\",\"node_4-内存.md\":\"f46282af\",\"engineering_docker入门学习笔记.md\":\"ff376321\",\"index.md\":\"7d09f51f\",\"node_index.md\":\"8a1ab16e\",\"node_2-异步io.md\":\"895f1efd\",\"node_1-模块的机制.md\":\"9f44250e\",\"fe-more_lighthouse第三方库审计--从现象到源码追踪.md\":\"fd3a4e95\",\"node_0-node简介.md\":\"e3f80330\",\"guide_v8.md\":\"2b94ea4e\",\"fe-more_微前端浅入.md\":\"c0d80493\",\"engineering_前端监控.md\":\"2bca1702\",\"react_about-useeffect.md\":\"fc4d4323\",\"node_5-buffer与stream.md\":\"6f782f02\",\"node_6-进程管理.md\":\"dc56679a\",\"react_simple-react-demo.md\":\"c465866d\",\"react_react单元测试.md\":\"b613a775\",\"浅入函数式编程.md\":\"3bfc0eed\",\"v8.md\":\"20795bcf\"}")</script>
    <script type="module" async src="/assets/app.ee7dae8a.js"></script>
    
  </body>
</html>